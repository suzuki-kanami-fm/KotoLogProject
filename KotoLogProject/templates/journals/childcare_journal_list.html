{% extends 'common/base.html' %}
{% block content %}
<section id="childcare_journal_list">
    {% if messages %}
      <div class="alert alert-success">
          {% for message in messages %}
              <p>{{ message }}</p>
          {% endfor %}
      </div>      
    {% endif %}
<form method="POST" action="{% url 'journals:delete_childcare_journals' %}" onsubmit="return confirmDelete()">
    {% csrf_token %}
    <button type="submit" class="btn btn-danger">選択した育児記録を削除</button>

{% if childcare_journals.exists %}
    <ul class="cards">
    {% for journal in childcare_journals %}
        <li class="card">
            <h5 class="card-title">
            {% if journal.child.family == request.user.family %}
                <span>{{ journal.child.child_name }}</span>
            {% endif %}
            {% if journal.is_favorited %}
                <span>★</span>
            {% endif %}
            </h5>
        {% if journal.user_id == request.user.id %}
        <input type="checkbox"  name="selected_journals" value="{{ journal.id }}">
        {% endif %}
        {% if journal.image_url %}
            <img src="{{ journal.image_url.url }}" class="card-img-top" alt="Journal Image" style="max-height: 200px; object-fit: cover;">
        {% endif %}
        <h6 class="card-subtitle mb-2 text-muted">{{ journal.title }}</h6>
        <p class="card-text">{{ journal.content|truncatewords:20 }}</p>
        <p class="card-text"><small class="text-muted">作成者: {{ journal.user.account_name }}</small></p>
        <button class="btn btn-primary" data-id="{{ journal.id }}" data-bs-toggle="modal" data-bs-target="#journalModal">詳細を見る</button>
        </li>
     {% endfor %}
    </ul>
</form>
{% else %}
    <p>育児記録が見つかりません。</p>
</section>

{% endif %}
  <!-- モーダルテンプレートの読み込み -->
    {% include 'journals/journal_detail.html' %}
<script>
// 削除確認メッセージを表示する
function confirmDelete() {
    return confirm('チェックした育児記録を本当に削除しますか？');
}
</script>    
{% endblock %}

